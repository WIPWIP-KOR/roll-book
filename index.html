<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <title>청라FS 출석체크</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ba33aab3a17f53b23105c96b7618df35"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>⚽ 청라FS ⚽</h1>
            <h2>출석 체크</h2>
            <div class="season-badge" id="seasonBadge">
                <span class="season-icon">🏆</span>
                <span class="season-text" id="seasonText">로딩 중...</span>
            </div>
        </div>

        <!-- 탭 네비게이션 -->
        <div class="tab-container">
            <button class="tab-btn active" data-tab="attend">📝 출석하기</button>
            <button class="tab-btn" data-tab="status">📊 출석현황</button>
        </div>

        <!-- 출석하기 탭 -->
        <div class="tab-content active" id="attendTab">
            <div class="tab-content-wrapper">
                <div class="attendance-form" id="attendanceForm">
                    <div class="form-group">
                        <label for="teamSelect">팀</label>
                        <select id="teamSelect">
                            <option value="">팀을 선택하세요</option>
                            <option value="A">A팀</option>
                            <option value="B">B팀</option>
                            <option value="C">C팀</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="nameSelect">이름</label>
                        <select id="nameSelect">
                            <option value="">이름을 선택하세요</option>
                        </select>
                        <input type="text" id="nameInput" placeholder="이름을 입력하세요" autocomplete="off" style="display: none;">
                    </div>

                    <div class="location-status" id="locationStatus">
                        <span class="status-icon">📍</span>
                        <span id="locationText">위치 정보 확인 중...</span>
                    </div>

                    <button id="attendBtn" class="btn-primary" disabled>출석하기</button>
                </div>
            </div>
        </div>

        <!-- 출석현황 탭 -->
        <div class="tab-content" id="statusTab">
            <div class="tab-content-wrapper">
                <h3 style="margin: 0 0 15px 0; color: #333;">📊 오늘 출석 현황</h3>
                <div id="todayStatus" class="attendance-list">
                    <p class="text-secondary">출석현황 탭을 클릭하면 데이터를 불러옵니다.</p>
                </div>

                <h3 style="margin: 30px 0 15px 0; color: #333;">📅 지난주 출석 현황</h3>
                <div id="lastWeekStatus" class="attendance-list">
                    <p class="text-secondary">지난주 출석 현황을 불러오는 중...</p>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>매주 토요일 출석 체크</p>
        </div>
    </div>

    <!-- 하단 네비게이션 -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item active">
            <span class="nav-icon">📝</span>
            <span class="nav-label">출석</span>
        </a>
        <a href="stats.html" class="nav-item">
            <span class="nav-icon">📊</span>
            <span class="nav-label">통계</span>
        </a>
        <a href="admin.html" class="nav-item">
            <span class="nav-icon">⚙️</span>
            <span class="nav-label">관리</span>
        </a>
    </nav>

    <!-- 상단 고정 토스트 메시지 -->
    <div id="message" class="message"></div>

    <!-- 위치 확인 지도 모달 -->
    <div id="locationMapModal" class="modal" style="display: none;">
        <div class="modal-content location-modal-content">
            <div class="modal-header">
                <h2>📍 현재 위치 확인</h2>
                <button id="closeMapModal" class="close-btn">&times;</button>
            </div>
            <div id="locationMap" class="location-map">
                <button id="currentLocationBtn" class="current-location-btn" title="현재 위치로 이동">
                    📍
                </button>
            </div>
        </div>
    </div>

    <!-- 출석 요청 모달 -->
    <div id="attendanceRequestModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>📝 출석 요청</h2>
                <button id="closeRequestModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: #666; margin-bottom: 20px;">
                    위치 오류나 기타 사유로 출석하지 못한 경우,<br>
                    관리자에게 출석 요청을 보낼 수 있습니다.
                </p>
                <div class="form-group">
                    <label for="requestReason">사유</label>
                    <textarea id="requestReason" rows="4" placeholder="출석하지 못한 사유를 입력해주세요&#10;(예: 위치 오류, GPS 문제 등)" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; font-family: inherit; resize: vertical;"></textarea>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button id="cancelRequestBtn" class="btn-secondary" style="flex: 1;">취소</button>
                    <button id="submitRequestBtn" class="btn-primary" style="flex: 1;">요청 제출</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/unregister-sw.js"></script>
    <script src="js/cache.js"></script>
    <script src="js/attendance.js"></script>
</body>
</html>
